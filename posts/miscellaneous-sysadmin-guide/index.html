<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Liste - https://its-ericjones.github.io">
    <title>Miscellaneous SysAdmin Guide | Eric Jones</title>
    <meta name="description" content="Technology Enthusiast | Casual Writer | All Around Nerd">
    <meta property="og:title" content="Miscellaneous SysAdmin Guide" />
<meta property="og:description" content="Jump to Specific Topic: Mounting External Hard Drive Mounting a SMB Share in Ubuntu Setting Up Samba SSH Keys Plex Server Installation and Backup (Linux) Configuring Plex Inside Docker (Ubuntu Jammy) Mounting External Hard Drive Plug in hard drive List all block devices with the name, size, file system type, mount location, and Universally Unique Identifier (take note of the UUID as it will be needed later on) - $ sudo lsblk -o NAME,SIZE,FSTYPE,TYPE,MOUNTPOINT,UUID Take note of the name of desired hard drive (name will be listed on far left side - i." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://its-ericjones.github.io/posts/miscellaneous-sysadmin-guide/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-07-17T19:41:04-07:00" />
<meta property="article:modified_time" content="2022-07-17T19:41:04-07:00" />

    <meta itemprop="name" content="Miscellaneous SysAdmin Guide">
<meta itemprop="description" content="Jump to Specific Topic: Mounting External Hard Drive Mounting a SMB Share in Ubuntu Setting Up Samba SSH Keys Plex Server Installation and Backup (Linux) Configuring Plex Inside Docker (Ubuntu Jammy) Mounting External Hard Drive Plug in hard drive List all block devices with the name, size, file system type, mount location, and Universally Unique Identifier (take note of the UUID as it will be needed later on) - $ sudo lsblk -o NAME,SIZE,FSTYPE,TYPE,MOUNTPOINT,UUID Take note of the name of desired hard drive (name will be listed on far left side - i."><meta itemprop="datePublished" content="2022-07-17T19:41:04-07:00" />
<meta itemprop="dateModified" content="2022-07-17T19:41:04-07:00" />
<meta itemprop="wordCount" content="1208">
<meta itemprop="keywords" content="self-hosted,tech," />
    
    <link rel="canonical" href="https://its-ericjones.github.io/posts/miscellaneous-sysadmin-guide/">
    <link rel="icon" href="https://its-ericjones.github.io/assets/favicon.ico">
    <link rel="dns-prefetch" href="https://www.google-analytics.com">
    <link href="https://www.google-analytics.com" rel="preconnect" crossorigin>
    <link rel="alternate" type="application/atom+xml" title="Eric Jones" href="https://its-ericjones.github.io/atom.xml" />
    <link rel="alternate" type="application/json" title="Eric Jones" href="https://its-ericjones.github.io/feed.json" />
    <link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII=">
    
    
    <style>*,:after,:before{box-sizing:border-box;padding:0}body{font:1rem/1.5 '-apple-system',BlinkMacSystemFont,avenir next,avenir,helvetica,helvetica neue,ubuntu,roboto,noto,segoe ui,arial,sans-serif;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;padding:2rem;background:#f5f5f5;color:#000}.skip-link{position:absolute;top:-40px;left:0;background:#eee;z-index:100}.skip-link:focus{top:0}h1,h2,h3,h4,h5,strong,b{font-size:inherit;font-weight:600}header{line-height:2;padding-bottom:1.5rem}.link{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-decoration:none}.time{font-variant-numeric:tabular-nums;white-space:nowrap}blockquote{border-left:5px solid #eee;padding-left:1rem;margin:0}a,a:visited{color:inherit}a:hover,a.heading-link{text-decoration:none}pre{padding:.5rem;overflow:auto;overflow-x:scroll;overflow-wrap:normal}code,pre{font-family:San Francisco Mono,Monaco,consolas,lucida console,dejavu sans mono,bitstream vera sans mono,monospace;font-size:normal;font-size:small;background:#eee}code{margin:.1rem;border:none}ul{list-style-type:square}ul,ol{padding-left:1.2rem}.list{line-height:2;list-style-type:none;padding-left:0}.list li{padding-bottom:.1rem}.meta{color:#777}.content{max-width:70ch;margin:0 auto}header{line-height:2;display:flex;justify-content:space-between;padding-bottom:1rem}header a{text-decoration:none}header ul{list-style-type:none;padding:0}header li,header a{display:inline}h2.post{padding-top:.5rem}header ul a:first-child{padding-left:1rem}.nav{height:1px;background:#000;content:'';max-width:10%}.list li{display:flex;align-items:baseline}.list li time{flex:initial}.hr-list{margin-top:0;margin-bottom:0;margin-right:.5rem;margin-left:.5rem;height:1px;border:0;border-bottom:1px dotted #ccc;flex:1 0 1rem}.m,hr{border:0;margin:3rem 0}img{max-width:100%;height:auto}.post-date{margin:5% 0}.index-date{color:#9a9a9a}.animate-blink{animation:opacity 1s infinite;opacity:1}@keyframes opacity{0%{opacity:1}50%{opacity:.5}100%{opacity:0}}.tags{display:flex;justify-content:space-between}.tags ul{padding:0;margin:0}.tags li{display:inline}.avatar{height:120px;width:120px;position:relative;margin:-10px 0 0 15px;float:right;border-radius:50%} </style>
  
    
  
  
  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "articleSection": "posts",
      "name": "Miscellaneous SysAdmin Guide",
      "headline": "Miscellaneous SysAdmin Guide",
      "alternativeHeadline": "",
      "description": "Jump to Specific Topic: Mounting External Hard Drive Mounting a SMB Share in Ubuntu Setting Up Samba SSH Keys Plex Server Installation and Backup (Linux) Configuring Plex Inside Docker (Ubuntu Jammy) Mounting External Hard Drive Plug in hard drive List all block devices with the name, size, file system type, mount location, and Universally Unique Identifier (take note of the UUID as it will be needed later on) - $ sudo lsblk -o NAME,SIZE,FSTYPE,TYPE,MOUNTPOINT,UUID Take note of the name of desired hard drive (name will be listed on far left side - i.",
      "inLanguage": "en-us",
      "isFamilyFriendly": "true",
      "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https:\/\/its-ericjones.github.io\/posts\/miscellaneous-sysadmin-guide\/"
      },
      "author" : {
          "@type": "Person",
          "name": ""
      },
      "creator" : {
          "@type": "Person",
          "name": ""
      },
      "accountablePerson" : {
          "@type": "Person",
          "name": ""
      },
      "copyrightHolder" : "Eric Jones",
      "copyrightYear" : "2022",
      "dateCreated": "2022-07-17T19:41:04.00Z",
      "datePublished": "2022-07-17T19:41:04.00Z",
      "dateModified": "2022-07-17T19:41:04.00Z",
      "publisher":{
          "@type":"Organization",
          "name": "Eric Jones",
          "url": "https://its-ericjones.github.io",
          "logo": {
              "@type": "ImageObject",
              "url": "https:\/\/its-ericjones.github.io\/assets\/favicon.ico",
              "width":"32",
              "height":"32"
          }
      },
      "image": "https://its-ericjones.github.io/assets/favicon.ico",
      "url" : "https:\/\/its-ericjones.github.io\/posts\/miscellaneous-sysadmin-guide\/",
      "wordCount" : "1208",
      "genre" : [ "self-hosted" , "tech" ],
      "keywords" : [ "self-hosted" , "tech" ]
  }
  </script>
  
  
  </head>

<body>
  <a class="skip-link" href="#main">Skip to main</a>
  <main id="main">
  <div class="content">
    <header>
<p style="padding: 0;margin: 0;">
  <a href="/">
    <b>Eric Jones</b>
    <span class="text-stone-500 animate-blink">▮</span>
  </a>
</p>
<ul style="padding: 0;margin: 0;">
  
  
  <li class="">
    <a href="/now/"><span>/now</span></a>
    
  <li class="">
    <a href="/posts/"><span>/posts</span></a>
    
  <li class="">
    <a href="/resume/"><span>/resume</span></a>
    
  </li>
</ul>
</header>
<hr class="hr-list" style="padding: 0;margin: 0;">
    <section>
      <h2 class="post">Miscellaneous SysAdmin Guide</h2>
      <h3 id="jump-to-specific-topic">Jump to Specific Topic:</h3>
<ul>
<li><a href="#mounting-external-hard-drive">Mounting External Hard Drive</a></li>
<li><a href="#mounting-a-smb-share-in-ubuntu">Mounting a SMB Share in Ubuntu</a></li>
<li><a href="#setting-up-samba">Setting Up Samba</a></li>
<li><a href="#ssh-keys">SSH Keys</a></li>
<li><a href="#plex-server-installation-and-backup-linux">Plex Server Installation and Backup (Linux)</a></li>
<li><a href="#configuring-plex-inside-docker-ubuntu-jammy">Configuring Plex Inside Docker (Ubuntu Jammy)</a></li>
</ul>
<h2 id="mounting-external-hard-drive">Mounting External Hard Drive</h2>
<ol>
<li>Plug in hard drive</li>
<li>List all block devices with the name, size, file system type, mount location, and Universally Unique Identifier (take note of the UUID as it will be needed later on) -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo lsblk -o NAME,SIZE,FSTYPE,TYPE,MOUNTPOINT,UUID 
</span></span></code></pre></div><ol start="3">
<li>Take note of the name of desired hard drive (name will be listed on far left side - i.e. sda2 = /dev/sda2)</li>
<li>Locate the mount location of the external drive -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo mount <span style="color:#f92672">[</span>NAME<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>MOUNT LOCATION<span style="color:#f92672">]</span> 
</span></span></code></pre></div><ol start="5">
<li>Check to make sure hard drive is mounted -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ df -h 
</span></span></code></pre></div><h3 id="enabling-external-hard-drive-mount-upon-reboot">Enabling External Hard Drive Mount Upon Reboot</h3>
<ol>
<li>Edit filesystem table -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo nano -Bw /etc/fstab 
</span></span></code></pre></div><ol start="2">
<li>Below last PARTUUID entry -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ <span style="color:#111">UUID</span><span style="color:#f92672">=[</span>INSERT UUID<span style="color:#f92672">]</span> /mnt/USB auto defaults,user,nofail <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">2</span> 
</span></span></code></pre></div><ol start="3">
<li>Press <code>^X</code> to exit, <code>Y</code> to save changes, and <code>Enter</code> to confirm</li>
<li>Make sure that hard drive will mount upon startup -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo reboot 
</span></span></code></pre></div><h2 id="mounting-a-smb-share-in-ubuntu">Mounting a SMB Share in Ubuntu</h2>
<p><em>This can either be done remotely via SSH from your local machine or directly on the server itself.</em></p>
<ol>
<li>Update packages -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get update <span style="color:#f92672">&amp;&amp;</span> sudo apt-get upgrade -y 
</span></span></code></pre></div><ol start="2">
<li>Install CIFS Utilities -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get install cifs-utils -y 
</span></span></code></pre></div><ol start="3">
<li>Create directories where you want network shares to mount (ex: /media/nas) -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ mkdir media/nas 
</span></span></code></pre></div><ol start="4">
<li>In home folder (/home/user) create a new text file inside a directory called <code>smb</code> that will contain the username and password of the network share -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ nano smb/.smbcredentials 
</span></span></code></pre></div><ol start="5">
<li>Inside text file -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#111">username</span><span style="color:#f92672">=[</span>username-of-server<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span><span style="color:#111">password</span><span style="color:#f92672">=[</span>password-of-server<span style="color:#f92672">]</span> 
</span></span></code></pre></div><ol start="6">
<li>Edit filesystem table -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo nano -Bw /etc/fstab 
</span></span></code></pre></div><ol start="7">
<li>Append the following at the bottom of the file -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>//SERVER-IP/name-of-share /path-to-mount-location cifs <span style="color:#111">credentials</span><span style="color:#f92672">=</span>/path/to/credentials/.smbcredentials,vers<span style="color:#f92672">=</span>3.0,uid<span style="color:#f92672">=</span>1000,gid<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span> <span style="color:#ae81ff">0</span> <span style="color:#ae81ff">0</span> 
</span></span></code></pre></div><ol start="8">
<li>Mount SMB share type</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo mount -a 
</span></span></code></pre></div><h2 id="setting-up-samba">Setting Up Samba</h2>
<p><em>A Samba file server enables file sharing across different operating systems over a network.</em></p>
<h3 id="samba-installation">Samba Installation</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get install samba samba-common-bin 
</span></span></code></pre></div><h3 id="samba-share-configuration">Samba Share Configuration</h3>
<ol>
<li>Edit smb configuration file -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo nano /etc/samba/smb.conf 
</span></span></code></pre></div><ol start="2">
<li>At the bottom of the file -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>INSERT LABEL OF HARD DRIVE<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span><span style="color:#111">comment</span> <span style="color:#f92672">=</span> LABEL OF HARD DRIVE 
</span></span><span style="display:flex;"><span><span style="color:#111">public</span> <span style="color:#f92672">=</span> no 
</span></span><span style="display:flex;"><span><span style="color:#111">writeable</span> <span style="color:#f92672">=</span> yes 
</span></span><span style="display:flex;"><span><span style="color:#111">browsable</span> <span style="color:#f92672">=</span> yes 
</span></span><span style="display:flex;"><span><span style="color:#111">path</span> <span style="color:#f92672">=</span> /path-to-mount-point 
</span></span><span style="display:flex;"><span>create <span style="color:#111">mask</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0777</span> 
</span></span><span style="display:flex;"><span>directory <span style="color:#111">mask</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0777</span> 
</span></span><span style="display:flex;"><span>only <span style="color:#111">guest</span> <span style="color:#f92672">=</span> no 
</span></span></code></pre></div><ol start="3">
<li>Require a login for server connection -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo smbpasswd -a pi 
</span></span></code></pre></div><h3 id="connect-to-server-with-login">Connect to Server with Login</h3>
<ol>
<li>Have Finder.app active and press <code>Command + K</code></li>
<li>Type <code>smb://[INSERT IP]</code></li>
<li>Click <code>Connect</code></li>
<li>Type in <code>pi</code> as username and your previously chosen password</li>
<li>Click on hard drive label to mount the server</li>
</ol>
<h2 id="ssh-keys">SSH Keys</h2>
<p><em>SSH Keys are stronger than plain text passwords since authentication requires both a private and public key pair.</em></p>
<h3 id="creating-a-ssh-key-on-mac">Creating a SSH Key on Mac</h3>
<ol>
<li>To generate a SSH Key -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ssh-keygen 
</span></span></code></pre></div><ol start="2">
<li>The prompt will ask where you want to store the RSA private and public keys. If you press <code>Enter</code> then both keys will be stored in the <code>.ssh</code> hidden directory.</li>
<li>The next prompt will ask if you want to enter a passphrase. I recommend doing this since leaving this blank will allow anyone who gains control of your private key to login to your servers.</li>
</ol>
<p><code>~/.ssh/id_rsa</code> - this is your private key (DO NOT SHARE THIS).</p>
<p><code>~/.ssh/id_rsa.pub</code> - this is your public key which you will be copying over to your server.</p>
<h3 id="storing-ssh-key-passphrase-in-keychain">Storing SSH Key Passphrase in Keychain</h3>
<p><strong>For MacOS Monterey or Later</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ssh-add --apple-use-keychain ~/.ssh/<span style="color:#f92672">[</span>your-private-key<span style="color:#f92672">]</span> 
</span></span></code></pre></div><p><strong>For MacOS Big Sur or Earlier</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ ssh-add -K ~/.ssh/<span style="color:#f92672">[</span>your-private-key<span style="color:#f92672">]</span> 
</span></span></code></pre></div><h2 id="configure-ssh-to-always-use-keychain">Configure SSH To Always Use Keychain</h2>
<ol>
<li>Create a config file in .ssh folder -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ touch config 
</span></span></code></pre></div><ol start="2">
<li>Type the following inside the config file</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Host <span style="color:#f92672">[</span>name-of-server<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>HostName <span style="color:#f92672">[</span>ip-address-of-server<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>UseKeychain yes 
</span></span><span style="display:flex;"><span>AddKeysToAgent yes 
</span></span><span style="display:flex;"><span>IdentityFile ~/.ssh/<span style="color:#f92672">[</span>your-private-key<span style="color:#f92672">]</span> 
</span></span></code></pre></div><h3 id="copying-public-key-to-server">Copying Public Key to Server</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh-copy-id -i ~/.ssh/<span style="color:#f92672">[</span>your-public-key<span style="color:#f92672">]</span> user@host 
</span></span></code></pre></div><h2 id="plex-server-installation-and-backup-linux">Plex Server Installation and Backup (Linux)</h2>
<p><em>Plex gives you one place to find and access all the media that matters to you. From personal media on your own server, to free and on-demand Movies &amp; Shows, live TV, podcasts, and web shows, to streaming music, you can enjoy it all in one app, on any device.</em></p>
<h2 id="plex-media-server-installation">Plex Media Server Installation</h2>
<h3 id="adding-plex-package-repository">Adding Plex Package Repository</h3>
<ol>
<li>Update and upgrade packages -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get update <span style="color:#f92672">&amp;&amp;</span> sudo apt-get upgrade -y 
</span></span></code></pre></div><ol start="2">
<li>Installing dependencies and repositories -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get install apt-transport-https 
</span></span><span style="display:flex;"><span>$ curl https://downloads.plex.tv/plex-keys/PlexSign.key <span style="color:#111">|</span> sudo apt-key add - 
</span></span><span style="display:flex;"><span>$ <span style="color:#111">echo</span> deb https://downloads.plex.tv/repo/deb public main <span style="color:#111">|</span> sudo tee /etc/apt/sources.list.d/plexmediaserver.list  
</span></span><span style="display:flex;"><span>$ sudo apt-get update 
</span></span></code></pre></div><h3 id="installing-plex-media-server-package">Installing Plex Media Server Package</h3>
<ol>
<li>Installing plexmediaserver -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt install plexmediaserver 
</span></span></code></pre></div><ol start="2">
<li>If this message <code>plexmediaserver.list (Y/I/N/O/D/Z) [default=N] ?</code> appears, type <code>N</code></li>
</ol>
<h3 id="setting-up-plex-server-via-web-browser">Setting up Plex Server via Web Browser</h3>
<ol>
<li>In web browser address bar type <code>[YOUR IP]:32400/web</code></li>
<li>Give server a name</li>
<li>Select “Add Library” in left-hand side column</li>
<li>Select desired type of media</li>
<li>When browsing for media click the parent folder that contains the desired media</li>
</ol>
<h2 id="plex-media-server-backup">Plex Media Server Backup</h2>
<h3 id="about-rsync">About Rsync</h3>
<p><em>*The rsync command synchronizes files from a source to a destination, on a local machine or over a secure network connection.*</em></p>
<p>Rsync Options: r = recursive | a = archive | v = verbose | u = update | P = partial / progress</p>
<h3 id="about-tar">About Tar</h3>
<p><em>*Tar stands for tape archive. It is an archiving file format. The tar command creates, maintains, modifies, and extracts files that are archived in the tar format.*</em></p>
<p>Tar Options: c = create | z = compress / uncompress | v = verbose | f = use the archive file | x = extract</p>
<h3 id="plex-media-server-data-directory-location">Plex Media Server Data Directory Location</h3>
<p>Location: /var/lib/plexmediaserver/Library/Application\ Support/</p>
<h3 id="copy-plex-directory-and-create-archived-file">Copy Plex Directory and Create Archived File</h3>
<ol>
<li>In main directory -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rsync -ravuP /var/lib/plexmediaserver/Library/Application<span style="color:#8045ff">\ </span>Support/ /home/pi/plex-backup/ 
</span></span><span style="display:flex;"><span>$ tar -czvf plexbackup.tar.gz /home/pi/plex-backup/Plex<span style="color:#8045ff">\ </span>Media<span style="color:#8045ff">\ </span>Server/ 
</span></span></code></pre></div><ol start="2">
<li>Type <code>ls</code> to verify and see &lsquo;plexbackup.tar.gz&rsquo; file</li>
</ol>
<h3 id="copy-tar-file-to-local-machine">Copy Tar File to Local Machine</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ rsync -avuPr <span style="color:#f92672">[</span>USERNAME<span style="color:#f92672">]</span>@<span style="color:#f92672">[</span>IP-ADDRESS<span style="color:#f92672">]</span>:plexbackup.tar.gz ~/path/of/desired/location 
</span></span></code></pre></div><h3 id="restoring-backup">Restoring Backup</h3>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ cp plexbackup.tar.gz /var/lib/plexmediaserver/Library/Application<span style="color:#8045ff">\ </span>Support/  
</span></span><span style="display:flex;"><span>$ tar -xf plexbackup.tar.gz 
</span></span></code></pre></div><ol start="2">
<li>Re-install Plex Media Server application</li>
</ol>
<h2 id="configuring-plex-inside-docker-ubuntu-jammy">Configuring Plex Inside Docker (Ubuntu Jammy)</h2>
<h2 id="docker--portainer-installation">Docker &amp; Portainer Installation</h2>
<ol>
<li>Update system -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt-get update -y 
</span></span></code></pre></div><ol start="3">
<li>Install the required dependencies for Docker -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt install apt-transport-https curl gnupg-agent ca-certificates software-properties-common -y
</span></span></code></pre></div><ol start="4">
<li>Add Docker CPG Key -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg <span style="color:#111">|</span> sudo apt-key add - 
</span></span></code></pre></div><ol start="5">
<li>Set up Docker repository -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo add-apt-repository <span style="color:#d88200">&#34;deb [arch=amd64] https://download.docker.com/linux/ubuntu focal stable&#34;</span>
</span></span></code></pre></div><ol start="6">
<li>Install Docker -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo apt install docker-ce docker-ce-cli containerd.io -y 
</span></span></code></pre></div><ol start="7">
<li>Add current user to Docker group -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo usermod -aG docker <span style="color:#f92672">[</span>user<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>$ newgrp docker
</span></span></code></pre></div><ol start="8">
<li>Start and Enable Docker -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo systemctl start docker <span style="color:#f92672">&amp;&amp;</span> systemctl <span style="color:#111">enable</span> docker 
</span></span></code></pre></div><ol start="9">
<li>Create Volume for Portainer -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo docker volume create portainer-data 
</span></span></code></pre></div><ol start="10">
<li>Pull Portainer Image From Docker Hub -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo docker run -d -p 9000:9000 -p 8000:8000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock -v /srv/portainer:/data portainer/portainer 
</span></span></code></pre></div><ol start="11">
<li>To access the web interface of Portainer type <code>[ip-address]:9000</code> into your address bar</li>
</ol>
<h2 id="plex-installation">Plex Installation</h2>
<ol>
<li>Install latest version of Plex container -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo docker pull linuxserver/plex 
</span></span></code></pre></div><ol start="2">
<li>Create Plex container (change TZ and path to media as applicable)</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo docker create <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>--name<span style="color:#f92672">=</span>plex <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>--net<span style="color:#f92672">=</span>host <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>--restart<span style="color:#f92672">=</span>always <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>-e <span style="color:#111">VERSION</span><span style="color:#f92672">=</span>latest <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>-e <span style="color:#111">PUID</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1001</span> -e <span style="color:#111">PGID</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1001</span> <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>-e <span style="color:#111">TZ</span><span style="color:#f92672">=</span>Europe/London <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>-v /home/docker/plex/config:/config <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>-v <span style="color:#f92672">[</span>path-to-tv-shows<span style="color:#f92672">]</span>:/data/tvshows <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>-v <span style="color:#f92672">[</span>path-to-movies<span style="color:#f92672">]</span>:/data/movies <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>-v /home/docker/plex/transcode:/transcode <span style="color:#8045ff">\ </span>
</span></span><span style="display:flex;"><span>linuxserver/plex 
</span></span></code></pre></div><ol start="3">
<li>Start Plex container -</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo docker start plex
</span></span></code></pre></div><ol start="4">
<li>Access web interface type <code>[IP-ADDRESS]:32400/web</code> into your address bar</li>
</ol>

      
      <div class="post-date">
        <span class="g time">July 17, 2022 </span> &#8729;
         
         <a href="https://its-ericjones.github.io/tags/self-hosted/">self-hosted</a> <a href="https://its-ericjones.github.io/tags/tech/">tech</a>
      </div>
      
    </section>
    
    <div id="comments">
      <script src="https://utteranc.es/client.js"
    repo=
    issue-term="pathname"
    theme=
    crossorigin="anonymous"
    async>
</script>

    </div>
    
  </div>
</main>
</body>
</html>
